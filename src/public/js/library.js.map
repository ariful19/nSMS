{"version":3,"file":"library.js","sources":["../../client/library/components/LibraryDashboardApp.vue","../../client/library/components/LibraryLoanApp.vue","../../client/library/components/LibraryBookApp.vue","../../client/library/main.js"],"sourcesContent":["<template>\n  <section class=\"card card--interactive\">\n    <header class=\"card__header\">\n      <div>\n        <h1 class=\"card__title\">Library workspace</h1>\n        <p class=\"card__subtitle\">Search the catalog, review activity, and add new titles.</p>\n      </div>\n    </header>\n\n    <div class=\"grid grid--two-column\">\n      <article class=\"card\">\n        <header class=\"card__header\">\n          <div>\n            <h2 class=\"card__title\">Catalog search</h2>\n            <p class=\"card__hint\">Filter by keyword or category.</p>\n          </div>\n        </header>\n        <form class=\"form\" @submit.prevent=\"loadBooks\">\n          <label class=\"form__group\">\n            <span>Keywords</span>\n            <input\n              v-model.trim=\"searchTerm\"\n              type=\"search\"\n              name=\"term\"\n              class=\"form__control\"\n              placeholder=\"Title, author, or ISBN\"\n            />\n          </label>\n          <label class=\"form__group\">\n            <span>Category</span>\n            <select v-model=\"selectedCategory\" class=\"form__control\">\n              <option value=\"\">All categories</option>\n              <option v-for=\"category in categories\" :key=\"category.id\" :value=\"category.id\">\n                {{ category.name }}\n              </option>\n            </select>\n          </label>\n          <div class=\"form__actions\">\n            <button type=\"submit\" class=\"btn btn--primary\" :disabled=\"isSearching\">\n              {{ isSearching ? \"Searching…\" : \"Search\" }}\n            </button>\n            <button type=\"button\" class=\"btn btn--ghost\" @click=\"resetSearch\" :disabled=\"isSearching\">\n              Clear\n            </button>\n          </div>\n        </form>\n        <div v-if=\"searchError\" class=\"alert alert--danger\">{{ searchError }}</div>\n        <div v-if=\"bookResults.length\" class=\"table-responsive\">\n          <table class=\"table\">\n            <thead>\n              <tr>\n                <th scope=\"col\">Title</th>\n                <th scope=\"col\">Author</th>\n                <th scope=\"col\">Category</th>\n                <th scope=\"col\">Available</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"book in bookResults\" :key=\"book.id\">\n                <th scope=\"row\">\n                  <a :href=\"`/library/books/${book.id}`\">{{ book.title }}</a>\n                </th>\n                <td>{{ book.author || \"—\" }}</td>\n                <td>{{ book.category?.name ?? \"Uncategorized\" }}</td>\n                <td>\n                  <strong>{{ book.copySummary.available }}</strong>\n                  of {{ book.copySummary.total }}\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n        <p v-else-if=\"!isSearching\" class=\"empty-state__title\">No books matched your filters.</p>\n      </article>\n\n      <article class=\"card\">\n        <header class=\"card__header\">\n          <div>\n            <h2 class=\"card__title\">Recent loan activity</h2>\n            <p class=\"card__hint\">Latest 10 check-outs and returns.</p>\n          </div>\n          <button type=\"button\" class=\"btn btn--ghost btn--small\" @click=\"loadRecentLoans\" :disabled=\"refreshingLoans\">\n            {{ refreshingLoans ? \"Refreshing…\" : \"Refresh\" }}\n          </button>\n        </header>\n        <div v-if=\"recentLoans.length\" class=\"table-responsive\">\n          <table class=\"table\">\n            <thead>\n              <tr>\n                <th scope=\"col\">Title</th>\n                <th scope=\"col\">Borrower</th>\n                <th scope=\"col\">Issued</th>\n                <th scope=\"col\">Status</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"loan in recentLoans\" :key=\"loan.id\">\n                <td>{{ loan.book?.title ?? \"—\" }}</td>\n                <td>{{ loan.student?.name ?? \"—\" }}</td>\n                <td>{{ formatDate(loan.issuedAt) }}</td>\n                <td>\n                  <span :class=\"['badge', loan.returnedAt ? 'badge--success' : 'badge--info']\">\n                    {{ loan.returnedAt ? `Returned ${formatDate(loan.returnedAt)}` : loan.dueAt ? `Due ${formatDate(loan.dueAt)}` : 'On loan' }}\n                  </span>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n        <p v-else class=\"empty-state__title\">No recent loan records.</p>\n      </article>\n    </div>\n\n    <article class=\"card\">\n      <header class=\"card__header\">\n        <div>\n          <h2 class=\"card__title\">Add a new book</h2>\n          <p class=\"card__hint\">Capture core metadata to grow the catalog.</p>\n        </div>\n        <button type=\"button\" class=\"btn btn--ghost btn--small\" @click=\"toggleCreate\">\n          {{ showCreateForm ? \"Hide form\" : \"Add book\" }}\n        </button>\n      </header>\n      <form v-if=\"showCreateForm\" class=\"form\" @submit.prevent=\"submitBook\">\n        <div class=\"grid grid--two-column\">\n          <label class=\"form__group\">\n            <span>Title</span>\n            <input v-model.trim=\"newBook.title\" type=\"text\" required class=\"form__control\" />\n          </label>\n          <label class=\"form__group\">\n            <span>Author</span>\n            <input v-model.trim=\"newBook.author\" type=\"text\" class=\"form__control\" />\n          </label>\n          <label class=\"form__group\">\n            <span>ISBN</span>\n            <input v-model.trim=\"newBook.isbn\" type=\"text\" class=\"form__control\" />\n          </label>\n          <label class=\"form__group\">\n            <span>Category</span>\n            <select v-model=\"newBook.categoryId\" class=\"form__control\">\n              <option value=\"\">Select category</option>\n              <option v-for=\"category in categories\" :key=\"category.id\" :value=\"category.id\">\n                {{ category.name }}\n              </option>\n            </select>\n          </label>\n          <label class=\"form__group\">\n            <span>Published year</span>\n            <input v-model.trim=\"newBook.publishedYear\" type=\"number\" min=\"0\" class=\"form__control\" />\n          </label>\n          <label class=\"form__group form__group--full\">\n            <span>Summary</span>\n            <textarea v-model.trim=\"newBook.summary\" rows=\"3\" class=\"form__control\"></textarea>\n          </label>\n        </div>\n        <div v-if=\"createError\" class=\"alert alert--danger\">{{ createError }}</div>\n        <div class=\"form__actions\">\n          <button type=\"submit\" class=\"btn btn--primary\" :disabled=\"isCreating\">\n            {{ isCreating ? \"Saving…\" : \"Save book\" }}\n          </button>\n          <button type=\"button\" class=\"btn btn--ghost\" @click=\"resetForm\" :disabled=\"isCreating\">\n            Reset\n          </button>\n        </div>\n      </form>\n      <p v-else class=\"empty-state__title\">Use the button above to capture a new title.</p>\n    </article>\n  </section>\n</template>\n\n<script setup>\nimport { computed, reactive, ref, watch } from \"vue\";\n\nconst props = defineProps({\n  categories: { type: Array, default: () => [] },\n  books: { type: Array, default: () => [] },\n  recentLoans: { type: Array, default: () => [] },\n  csrfToken: { type: String, default: \"\" },\n});\n\nconst categories = computed(() => props.categories ?? []);\nconst searchTerm = ref(\"\");\nconst selectedCategory = ref(\"\");\nconst isSearching = ref(false);\nconst searchError = ref(\"\");\nconst refreshingLoans = ref(false);\nconst bookResults = ref([]);\nconst recentLoans = ref([]);\nconst showCreateForm = ref(false);\nconst createError = ref(\"\");\nconst isCreating = ref(false);\nconst newBook = reactive({\n  title: \"\",\n  author: \"\",\n  isbn: \"\",\n  categoryId: \"\",\n  publishedYear: \"\",\n  summary: \"\",\n});\n\nwatch(\n  () => props.books,\n  (value) => {\n    bookResults.value = Array.isArray(value) ? value : [];\n  },\n  { immediate: true }\n);\n\nwatch(\n  () => props.recentLoans,\n  (value) => {\n    recentLoans.value = Array.isArray(value) ? value : [];\n  },\n  { immediate: true }\n);\n\nfunction formatDate(value) {\n  const date = new Date(value);\n  if (Number.isNaN(date.getTime())) {\n    return \"—\";\n  }\n  return date.toLocaleDateString();\n}\n\nasync function loadBooks() {\n  isSearching.value = true;\n  searchError.value = \"\";\n  try {\n    const params = new URLSearchParams();\n    if (searchTerm.value) {\n      params.set(\"term\", searchTerm.value);\n    }\n    if (selectedCategory.value) {\n      params.set(\"categoryId\", String(selectedCategory.value));\n    }\n    const response = await fetch(`/library/api/books?${params.toString()}`);\n    if (!response.ok) {\n      throw new Error(`Request failed with status ${response.status}`);\n    }\n    const data = await response.json();\n    bookResults.value = Array.isArray(data.results) ? data.results : [];\n  } catch (error) {\n    console.error(error);\n    searchError.value = \"Unable to load books. Please try again.\";\n  } finally {\n    isSearching.value = false;\n  }\n}\n\nfunction resetSearch() {\n  searchTerm.value = \"\";\n  selectedCategory.value = \"\";\n  bookResults.value = Array.isArray(props.books) ? props.books : [];\n  searchError.value = \"\";\n}\n\nfunction toggleCreate() {\n  showCreateForm.value = !showCreateForm.value;\n}\n\nfunction resetForm() {\n  newBook.title = \"\";\n  newBook.author = \"\";\n  newBook.isbn = \"\";\n  newBook.categoryId = \"\";\n  newBook.publishedYear = \"\";\n  newBook.summary = \"\";\n  createError.value = \"\";\n}\n\nasync function submitBook() {\n  if (!newBook.title) {\n    createError.value = \"Title is required.\";\n    return;\n  }\n  isCreating.value = true;\n  createError.value = \"\";\n  try {\n    const response = await fetch(\"/library/books\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"X-CSRF-Token\": props.csrfToken,\n      },\n      body: JSON.stringify(newBook),\n    });\n    if (!response.ok) {\n      const data = await response.json().catch(() => ({ error: \"\" }));\n      throw new Error(data.error || `Request failed with status ${response.status}`);\n    }\n    resetForm();\n    showCreateForm.value = false;\n    await loadBooks();\n    await loadRecentLoans();\n  } catch (error) {\n    console.error(error);\n    createError.value = error.message || \"Unable to save book.\";\n  } finally {\n    isCreating.value = false;\n  }\n}\n\nasync function loadRecentLoans() {\n  refreshingLoans.value = true;\n  try {\n    const response = await fetch(\"/library/api/loans/recent?limit=10\");\n    if (!response.ok) {\n      throw new Error(`Request failed with status ${response.status}`);\n    }\n    const data = await response.json();\n    recentLoans.value = Array.isArray(data.loans) ? data.loans : [];\n  } catch (error) {\n    console.error(error);\n  } finally {\n    refreshingLoans.value = false;\n  }\n}\n</script>\n","<template>\n  <section class=\"card\">\n    <header class=\"card__header\">\n      <div>\n        <h2 class=\"card__title\">Issue a loan</h2>\n        <p class=\"card__hint\">Choose an available copy and borrower.</p>\n      </div>\n    </header>\n\n    <form class=\"form\" @submit.prevent=\"submitLoan\">\n      <label class=\"form__group\">\n        <span>Available copy</span>\n        <select v-model=\"selectedCopyId\" class=\"form__control\" required>\n          <option value=\"\">Select copy</option>\n          <option v-for=\"copy in availableCopies\" :key=\"copy.id\" :value=\"copy.id\">\n            {{ copy.barcode || copy.id }} — {{ copy.location || \"No location\" }}\n          </option>\n        </select>\n      </label>\n\n      <label class=\"form__group\">\n        <span>Borrower</span>\n        <input\n          v-model.trim=\"searchTerm\"\n          type=\"search\"\n          class=\"form__control\"\n          placeholder=\"Search students by name or number\"\n          @input=\"handleSearchInput\"\n        />\n      </label>\n\n      <ul v-if=\"searchResults.length\" class=\"list list--compact\">\n        <li\n          v-for=\"result in searchResults\"\n          :key=\"result.id\"\n          class=\"list__option\"\n          @click=\"selectStudent(result)\"\n        >\n          <div>\n            <div class=\"list__heading\">{{ result.label }}</div>\n            <div class=\"list__description\">{{ result.studentNumber || \"No number\" }}</div>\n          </div>\n          <button type=\"button\" class=\"btn btn--ghost btn--small\">Select</button>\n        </li>\n      </ul>\n\n      <p v-if=\"selectedStudent\" class=\"alert alert--info\">\n        Selected: <strong>{{ selectedStudent.label }}</strong>\n      </p>\n\n      <label class=\"form__group\">\n        <span>Due date</span>\n        <input v-model=\"dueAt\" type=\"date\" class=\"form__control\" />\n      </label>\n\n      <label class=\"form__group\">\n        <span>Notes</span>\n        <textarea v-model.trim=\"notes\" rows=\"2\" class=\"form__control\" placeholder=\"Optional\" />\n      </label>\n\n      <div v-if=\"error\" class=\"alert alert--danger\">{{ error }}</div>\n\n      <div class=\"form__actions\">\n        <button type=\"submit\" class=\"btn btn--primary\" :disabled=\"isSubmitting\">\n          {{ isSubmitting ? \"Saving…\" : \"Record loan\" }}\n        </button>\n        <button type=\"button\" class=\"btn btn--ghost\" @click=\"resetForm\" :disabled=\"isSubmitting\">\n          Clear\n        </button>\n      </div>\n    </form>\n  </section>\n</template>\n\n<script setup>\nimport { computed, ref, watch } from \"vue\";\n\nconst props = defineProps({\n  copies: { type: Array, default: () => [] },\n  csrfToken: { type: String, default: \"\" },\n  bookId: { type: Number, default: null },\n  studentSearchEndpoint: { type: String, default: \"/library/api/students\" },\n});\n\nconst emit = defineEmits([\"loan-issued\"]);\n\nconst searchTerm = ref(\"\");\nconst selectedCopyId = ref(\"\");\nconst selectedStudent = ref(null);\nconst searchResults = ref([]);\nconst isSearching = ref(false);\nconst isSubmitting = ref(false);\nconst error = ref(\"\");\nconst dueAt = ref(\"\");\nconst notes = ref(\"\");\nlet searchTimeout = null;\n\nconst availableCopies = computed(() => (props.copies ?? []).filter((copy) => copy.status === \"AVAILABLE\"));\n\nwatch(\n  () => props.copies,\n  () => {\n    if (!availableCopies.value.find((copy) => copy.id === Number(selectedCopyId.value))) {\n      selectedCopyId.value = \"\";\n    }\n  }\n);\n\nfunction resetForm() {\n  searchTerm.value = \"\";\n  selectedCopyId.value = \"\";\n  selectedStudent.value = null;\n  searchResults.value = [];\n  dueAt.value = \"\";\n  notes.value = \"\";\n  error.value = \"\";\n}\n\nfunction handleSearchInput() {\n  if (searchTimeout) {\n    window.clearTimeout(searchTimeout);\n  }\n  if (!searchTerm.value) {\n    searchResults.value = [];\n    selectedStudent.value = null;\n    return;\n  }\n  searchTimeout = window.setTimeout(runSearch, 250);\n}\n\nasync function runSearch() {\n  if (!searchTerm.value) {\n    return;\n  }\n  isSearching.value = true;\n  try {\n    const params = new URLSearchParams({ term: searchTerm.value });\n    const response = await fetch(`${props.studentSearchEndpoint}?${params.toString()}`);\n    if (!response.ok) {\n      throw new Error(`Request failed with status ${response.status}`);\n    }\n    const data = await response.json();\n    searchResults.value = Array.isArray(data.results) ? data.results : [];\n  } catch (error_) {\n    console.error(error_);\n    error.value = \"Unable to search for students.\";\n  } finally {\n    isSearching.value = false;\n  }\n}\n\nfunction selectStudent(result) {\n  selectedStudent.value = result;\n  searchResults.value = [];\n  searchTerm.value = result.label;\n}\n\nasync function submitLoan() {\n  if (!selectedCopyId.value || !selectedStudent.value) {\n    error.value = \"Select a copy and borrower before recording the loan.\";\n    return;\n  }\n  isSubmitting.value = true;\n  error.value = \"\";\n  try {\n    const response = await fetch(\"/library/loans\", {\n      method: \"POST\",\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n        \"X-CSRF-Token\": props.csrfToken,\n      },\n      body: JSON.stringify({\n        copyId: selectedCopyId.value,\n        studentId: selectedStudent.value.id,\n        dueAt: dueAt.value || undefined,\n        bookId: props.bookId,\n        notes: notes.value || undefined,\n      }),\n    });\n    let data = null;\n    try {\n      data = await response.json();\n    } catch (parseError) {\n      data = null;\n    }\n    if (!response.ok) {\n      const errorMessage = data?.error || `Request failed with status ${response.status}`;\n      throw new Error(errorMessage);\n    }\n    if (!data || typeof data !== \"object\") {\n      throw new Error(\"Invalid response received from server.\");\n    }\n    emit(\"loan-issued\", data.loan);\n    resetForm();\n  } catch (error_) {\n    console.error(error_);\n    error.value = error_.message || \"Unable to record loan.\";\n  } finally {\n    isSubmitting.value = false;\n  }\n}\n</script>\n","<template>\n  <section class=\"grid grid--two-column\">\n    <article class=\"card card--interactive\">\n      <header class=\"card__header\">\n        <div>\n          <h1 class=\"card__title\">{{ form.title || \"Untitled book\" }}</h1>\n          <p class=\"card__hint\">Update book metadata to keep the catalog current.</p>\n        </div>\n      </header>\n      <form class=\"form\" @submit.prevent=\"saveBook\">\n        <div class=\"grid grid--two-column\">\n          <label class=\"form__group\">\n            <span>Title</span>\n            <input v-model.trim=\"form.title\" type=\"text\" required class=\"form__control\" />\n          </label>\n          <label class=\"form__group\">\n            <span>Author</span>\n            <input v-model.trim=\"form.author\" type=\"text\" class=\"form__control\" />\n          </label>\n          <label class=\"form__group\">\n            <span>ISBN</span>\n            <input v-model.trim=\"form.isbn\" type=\"text\" class=\"form__control\" />\n          </label>\n          <label class=\"form__group\">\n            <span>Category</span>\n            <select v-model=\"form.categoryId\" class=\"form__control\">\n              <option value=\"\">Uncategorized</option>\n              <option v-for=\"category in categories\" :key=\"category.id\" :value=\"category.id\">\n                {{ category.name }}\n              </option>\n            </select>\n          </label>\n          <label class=\"form__group\">\n            <span>Published year</span>\n            <input v-model.trim=\"form.publishedYear\" type=\"number\" min=\"0\" class=\"form__control\" />\n          </label>\n          <label class=\"form__group form__group--full\">\n            <span>Summary</span>\n            <textarea v-model.trim=\"form.summary\" rows=\"3\" class=\"form__control\"></textarea>\n          </label>\n        </div>\n        <label class=\"form__group form__group--checkbox\">\n          <input v-model=\"form.isArchived\" type=\"checkbox\" />\n          <span>Archive this title</span>\n        </label>\n        <div v-if=\"formError\" class=\"alert alert--danger\">{{ formError }}</div>\n        <div v-if=\"formMessage\" class=\"alert alert--success\">{{ formMessage }}</div>\n        <div class=\"form__actions\">\n          <button type=\"submit\" class=\"btn btn--primary\" :disabled=\"isSaving\">\n            {{ isSaving ? \"Saving…\" : \"Save changes\" }}\n          </button>\n          <button type=\"button\" class=\"btn btn--ghost\" @click=\"resetForm\" :disabled=\"isSaving\">\n            Reset\n          </button>\n        </div>\n      </form>\n    </article>\n\n    <LibraryLoanApp\n      :copies=\"bookState.copies\"\n      :csrf-token=\"csrfToken\"\n      :book-id=\"bookState.id\"\n      @loan-issued=\"handleLoanIssued\"\n    />\n\n    <article class=\"card\">\n      <header class=\"card__header\">\n        <div>\n          <h2 class=\"card__title\">Copy inventory</h2>\n          <p class=\"card__hint\">Track each barcode assigned to this title.</p>\n        </div>\n      </header>\n      <div v-if=\"bookState.copies.length\" class=\"table-responsive\">\n        <table class=\"table\">\n          <thead>\n            <tr>\n              <th scope=\"col\">Barcode</th>\n              <th scope=\"col\">Location</th>\n              <th scope=\"col\">Status</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"copy in bookState.copies\" :key=\"copy.id\">\n              <td>{{ copy.barcode || copy.id }}</td>\n              <td>{{ copy.location || \"—\" }}</td>\n              <td>{{ copy.status }}</td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n      <p v-else class=\"empty-state__title\">No copies recorded.</p>\n    </article>\n\n    <article class=\"card\">\n      <header class=\"card__header\">\n        <div>\n          <h2 class=\"card__title\">Add a copy</h2>\n          <p class=\"card__hint\">Register additional barcodes for circulation.</p>\n        </div>\n      </header>\n      <form class=\"form\" @submit.prevent=\"addCopy\">\n        <div class=\"grid grid--two-column\">\n          <label class=\"form__group\">\n            <span>Barcode</span>\n            <input v-model.trim=\"copyForm.barcode\" type=\"text\" class=\"form__control\" placeholder=\"Optional\" />\n          </label>\n          <label class=\"form__group\">\n            <span>Location</span>\n            <input v-model.trim=\"copyForm.location\" type=\"text\" class=\"form__control\" />\n          </label>\n          <label class=\"form__group\">\n            <span>Status</span>\n            <select v-model=\"copyForm.status\" class=\"form__control\">\n              <option value=\"AVAILABLE\">Available</option>\n              <option value=\"LOANED\">On loan</option>\n              <option value=\"MAINTENANCE\">Maintenance</option>\n              <option value=\"LOST\">Lost</option>\n            </select>\n          </label>\n          <label class=\"form__group\">\n            <span>Acquired date</span>\n            <input v-model=\"copyForm.acquiredAt\" type=\"date\" class=\"form__control\" />\n          </label>\n        </div>\n        <div v-if=\"copyError\" class=\"alert alert--danger\">{{ copyError }}</div>\n        <div v-if=\"copyMessage\" class=\"alert alert--success\">{{ copyMessage }}</div>\n        <div class=\"form__actions\">\n          <button type=\"submit\" class=\"btn btn--primary\" :disabled=\"copySubmitting\">\n            {{ copySubmitting ? \"Saving…\" : \"Add copy\" }}\n          </button>\n          <button type=\"button\" class=\"btn btn--ghost\" @click=\"resetCopyForm\" :disabled=\"copySubmitting\">\n            Reset\n          </button>\n        </div>\n      </form>\n    </article>\n\n    <article class=\"card\">\n      <header class=\"card__header\">\n        <div>\n          <h2 class=\"card__title\">Active loans</h2>\n          <p class=\"card__hint\">Close out loans when items are returned.</p>\n        </div>\n      </header>\n      <div v-if=\"activeLoanList.length\" class=\"table-responsive\">\n        <table class=\"table\">\n          <thead>\n            <tr>\n              <th scope=\"col\">Copy</th>\n              <th scope=\"col\">Borrower</th>\n              <th scope=\"col\">Issued</th>\n              <th scope=\"col\">Due</th>\n              <th scope=\"col\">Action</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"loan in activeLoanList\" :key=\"loan.id\">\n              <td>{{ loan.copy?.barcode || loan.copy?.id || \"—\" }}</td>\n              <td>{{ loan.student?.name || \"—\" }}</td>\n              <td>{{ formatDate(loan.issuedAt) }}</td>\n              <td>{{ formatDate(loan.dueAt) }}</td>\n              <td>\n                <button type=\"button\" class=\"btn btn--ghost btn--small\" @click=\"returnLoan(loan)\" :disabled=\"returningLoanId === loan.id\">\n                  {{ returningLoanId === loan.id ? \"Saving…\" : \"Mark returned\" }}\n                </button>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n      <p v-else class=\"empty-state__title\">No active loans recorded.</p>\n      <div v-if=\"loanError\" class=\"alert alert--danger\">{{ loanError }}</div>\n    </article>\n\n    <article class=\"card\">\n      <header class=\"card__header\">\n        <div>\n          <h2 class=\"card__title\">Recent activity</h2>\n          <p class=\"card__hint\">Chronological list of loan events for this title.</p>\n        </div>\n        <button type=\"button\" class=\"btn btn--ghost btn--small\" @click=\"refreshState\" :disabled=\"isRefreshing\">\n          {{ isRefreshing ? \"Refreshing…\" : \"Refresh\" }}\n        </button>\n      </header>\n      <div v-if=\"recentLoanList.length\" class=\"table-responsive\">\n        <table class=\"table\">\n          <thead>\n            <tr>\n              <th scope=\"col\">Copy</th>\n              <th scope=\"col\">Borrower</th>\n              <th scope=\"col\">Issued</th>\n              <th scope=\"col\">Status</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"loan in recentLoanList\" :key=\"loan.id\">\n              <td>{{ loan.copy?.barcode || loan.copy?.id || \"—\" }}</td>\n              <td>{{ loan.student?.name || \"—\" }}</td>\n              <td>{{ formatDate(loan.issuedAt) }}</td>\n              <td>\n                <span :class=\"['badge', loan.returnedAt ? 'badge--success' : 'badge--info']\">\n                  {{ loan.returnedAt ? `Returned ${formatDate(loan.returnedAt)}` : loan.dueAt ? `Due ${formatDate(loan.dueAt)}` : 'On loan' }}\n                </span>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n      <p v-else class=\"empty-state__title\">No historical activity yet.</p>\n    </article>\n  </section>\n</template>\n\n<script setup>\nimport { computed, reactive, ref, watch } from \"vue\";\nimport LibraryLoanApp from \"./LibraryLoanApp.vue\";\n\nconst props = defineProps({\n  book: { type: Object, default: () => ({}) },\n  activeLoans: { type: Array, default: () => [] },\n  recentLoans: { type: Array, default: () => [] },\n  categories: { type: Array, default: () => [] },\n  csrfToken: { type: String, default: \"\" },\n});\n\nconst bookState = reactive({ ...props.book, copies: props.book?.copies ?? [] });\nconst activeLoanList = ref([...props.activeLoans]);\nconst recentLoanList = ref([...props.recentLoans]);\nconst isSaving = ref(false);\nconst formError = ref(\"\");\nconst formMessage = ref(\"\");\nconst copyForm = reactive({ barcode: \"\", location: \"\", status: \"AVAILABLE\", acquiredAt: \"\" });\nconst copySubmitting = ref(false);\nconst copyError = ref(\"\");\nconst copyMessage = ref(\"\");\nconst loanError = ref(\"\");\nconst returningLoanId = ref(null);\nconst isRefreshing = ref(false);\n\nconst form = reactive({\n  id: bookState.id,\n  title: bookState.title || \"\",\n  author: bookState.author || \"\",\n  isbn: bookState.isbn || \"\",\n  categoryId: bookState.category?.id || \"\",\n  publishedYear: bookState.publishedYear ? String(bookState.publishedYear) : \"\",\n  summary: bookState.summary || \"\",\n  isArchived: Boolean(bookState.isArchived),\n});\n\nwatch(\n  () => props.book,\n  (value) => {\n    Object.assign(bookState, value || {});\n    if (value?.copies) {\n      bookState.copies = value.copies;\n    }\n    form.id = bookState.id;\n    form.title = bookState.title || \"\";\n    form.author = bookState.author || \"\";\n    form.isbn = bookState.isbn || \"\";\n    form.categoryId = bookState.category?.id || \"\";\n    form.publishedYear = bookState.publishedYear ? String(bookState.publishedYear) : \"\";\n    form.summary = bookState.summary || \"\";\n    form.isArchived = Boolean(bookState.isArchived);\n  }\n);\n\nwatch(\n  () => props.activeLoans,\n  (value) => {\n    activeLoanList.value = Array.isArray(value) ? [...value] : [];\n  }\n);\n\nwatch(\n  () => props.recentLoans,\n  (value) => {\n    recentLoanList.value = Array.isArray(value) ? [...value] : [];\n  }\n);\n\nconst categories = computed(() => props.categories ?? []);\n\nfunction resetForm() {\n  form.title = bookState.title || \"\";\n  form.author = bookState.author || \"\";\n  form.isbn = bookState.isbn || \"\";\n  form.categoryId = bookState.category?.id || \"\";\n  form.publishedYear = bookState.publishedYear ? String(bookState.publishedYear) : \"\";\n  form.summary = bookState.summary || \"\";\n  form.isArchived = Boolean(bookState.isArchived);\n  formError.value = \"\";\n  formMessage.value = \"\";\n}\n\nfunction formatDate(value) {\n  if (!value) {\n    return \"—\";\n  }\n  const date = new Date(value);\n  if (Number.isNaN(date.getTime())) {\n    return \"—\";\n  }\n  return date.toLocaleDateString();\n}\n\nasync function saveBook() {\n  if (!form.title) {\n    formError.value = \"Title is required.\";\n    return;\n  }\n  isSaving.value = true;\n  formError.value = \"\";\n  formMessage.value = \"\";\n  try {\n    const response = await fetch(`/library/books/${bookState.id}`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"X-CSRF-Token\": props.csrfToken,\n      },\n      body: JSON.stringify(form),\n    });\n    if (!response.ok) {\n      const data = await response.json().catch(() => ({ error: \"\" }));\n      throw new Error(data.error || `Request failed with status ${response.status}`);\n    }\n    formMessage.value = \"Book updated successfully.\";\n    await refreshState();\n  } catch (error) {\n    console.error(error);\n    formError.value = error.message || \"Unable to update book.\";\n  } finally {\n    isSaving.value = false;\n  }\n}\n\nasync function addCopy() {\n  copySubmitting.value = true;\n  copyError.value = \"\";\n  copyMessage.value = \"\";\n  try {\n    const response = await fetch(`/library/books/${bookState.id}/copies`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"X-CSRF-Token\": props.csrfToken,\n      },\n      body: JSON.stringify(copyForm),\n    });\n    if (!response.ok) {\n      const data = await response.json().catch(() => ({ error: \"\" }));\n      throw new Error(data.error || `Request failed with status ${response.status}`);\n    }\n    copyMessage.value = \"Copy added successfully.\";\n    resetCopyForm();\n    await refreshState();\n  } catch (error) {\n    console.error(error);\n    copyError.value = error.message || \"Unable to add copy.\";\n  } finally {\n    copySubmitting.value = false;\n  }\n}\n\nfunction resetCopyForm() {\n  copyForm.barcode = \"\";\n  copyForm.location = \"\";\n  copyForm.status = \"AVAILABLE\";\n  copyForm.acquiredAt = \"\";\n}\n\nasync function returnLoan(loan) {\n  returningLoanId.value = loan.id;\n  loanError.value = \"\";\n  try {\n    const response = await fetch(`/library/loans/${loan.id}/return`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"X-CSRF-Token\": props.csrfToken,\n      },\n      body: JSON.stringify({ returnedAt: new Date().toISOString() }),\n    });\n    if (!response.ok) {\n      const data = await response.json().catch(() => ({ error: \"\" }));\n      throw new Error(data.error || `Request failed with status ${response.status}`);\n    }\n    await refreshState();\n  } catch (error) {\n    console.error(error);\n    loanError.value = error.message || \"Unable to mark loan as returned.\";\n  } finally {\n    returningLoanId.value = null;\n  }\n}\n\nasync function refreshState() {\n  isRefreshing.value = true;\n  loanError.value = \"\";\n  try {\n    const response = await fetch(`/library/books/${bookState.id}`, {\n      headers: { Accept: \"application/json\" },\n    });\n    if (!response.ok) {\n      throw new Error(`Request failed with status ${response.status}`);\n    }\n    const data = await response.json();\n    Object.assign(bookState, data.book || {});\n    bookState.copies = data.book?.copies ?? [];\n    activeLoanList.value = Array.isArray(data.activeLoans) ? data.activeLoans : [];\n    recentLoanList.value = Array.isArray(data.recentLoans) ? data.recentLoans : [];\n  } catch (error) {\n    console.error(error);\n    loanError.value = error.message || \"Unable to refresh book details.\";\n  } finally {\n    isRefreshing.value = false;\n  }\n}\n\nasync function handleLoanIssued() {\n  await refreshState();\n}\n</script>\n","import { createApp } from \"vue\";\nimport { registerSharedComponents } from \"../shared/registerComponents\";\nimport LibraryDashboardApp from \"./components/LibraryDashboardApp.vue\";\nimport LibraryBookApp from \"./components/LibraryBookApp.vue\";\nimport LibraryLoanApp from \"./components/LibraryLoanApp.vue\";\n\nregisterSharedComponents();\n\nconst COMPONENTS = {\n  LibraryDashboardApp,\n  LibraryBookApp,\n  LibraryLoanApp,\n};\n\nfunction readState(stateId) {\n  if (!stateId) {\n    return {};\n  }\n  const el = document.getElementById(stateId);\n  if (!el) {\n    return {};\n  }\n  try {\n    return JSON.parse(el.textContent || \"{}\");\n  } catch (error) {\n    console.warn(`Unable to parse state for ${stateId}`, error);\n    return {};\n  }\n}\n\nfunction mountComponent(el) {\n  const componentName = el.dataset.vueApp;\n  const Component = COMPONENTS[componentName];\n  if (!Component) {\n    return;\n  }\n  const props = readState(el.dataset.stateId);\n  createApp(Component, props).mount(el);\n}\n\nArray.from(document.querySelectorAll('[data-vue-app^=\"Library\"]')).forEach((el) =>\n  mountComponent(el)\n);\n"],"names":["props","__props","categories","computed","searchTerm","ref","selectedCategory","isSearching","searchError","refreshingLoans","bookResults","recentLoans","showCreateForm","createError","isCreating","newBook","reactive","watch","value","formatDate","date","loadBooks","params","response","data","error","resetSearch","toggleCreate","resetForm","submitBook","loadRecentLoans","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_hoisted_4","_cache","$event","_hoisted_5","_Fragment","_renderList","category","_toDisplayString","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","book","_hoisted_13","_hoisted_14","_a","_createTextVNode","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","loan","_b","_normalizeClass","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_vModelSelect","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","emit","__emit","selectedCopyId","selectedStudent","searchResults","isSubmitting","dueAt","notes","searchTimeout","availableCopies","copy","handleSearchInput","runSearch","error_","selectStudent","result","submitLoan","errorMessage","bookState","activeLoanList","recentLoanList","isSaving","formError","formMessage","copyForm","copySubmitting","copyError","copyMessage","loanError","returningLoanId","isRefreshing","form","saveBook","refreshState","addCopy","resetCopyForm","returnLoan","handleLoanIssued","_vModelCheckbox","_createVNode","LibraryLoanApp","_vModelText","_c","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","COMPONENTS","LibraryDashboardApp","LibraryBookApp","readState","stateId","el","mountComponent","componentName","Component","createApp"],"mappings":"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"}
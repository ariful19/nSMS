import{r as C,c as I,a as m,b as e,d as Y,t as r,w as g,v as D,e as O,F as h,f as A,g as M,h as E,o as f,i as G,j as T,k as B,l as W,n as P,m as H,T as K,u as S,p as Z}from"./chunks/sq-avatar-badge-iwxELXVT.js";import{_ as F}from"./chunks/_plugin-vue_export-helper-DlAUqK2U.js";const ee={class:"card card--interactive"},te={class:"card__header"},le={class:"card__subtitle"},se={class:"filters",method:"get",action:"/students",novalidate:""},ne={class:"filters__field"},oe={class:"filters__field"},ae=["value"],re={class:"filters__field"},ie=["value"],de={class:"filters__checkbox"},ue={key:0,class:"table-responsive"},me={class:"table"},fe={"data-title":"Name"},pe=["onClick"],ve={"data-title":"Status"},be={"data-title":"Grade"},_e={"data-title":"Student #"},ce={class:"table__actions"},ge=["href"],ye=["href"],Se=["action"],Ne=["value"],$e={key:1,class:"table__empty"},ke=["open"],Ie=["name","subtitle"],he={class:"summary"},De={slot:"footer",class:"modal-footer"},Ce=["href"],Ve={__name:"StudentListApp",props:{students:{type:Array,default:()=>[]},search:{type:String,default:""},lookups:{type:Object,default:()=>({statuses:[],gradeLevels:[]})},csrfToken:{type:String,default:""}},setup(p){const i=p,d=C(i.search??""),n=C("all"),y=C("all"),$=C(!1),b=C(null),k=I(()=>{var a;return((a=i.lookups)==null?void 0:a.statuses)??[]}),_=I(()=>{var a;return((a=i.lookups)==null?void 0:a.gradeLevels)??[]}),w=I(()=>{var a;return new Set((((a=i.lookups)==null?void 0:a.statuses)??[]).filter(s=>s.isActive!==!1).map(s=>String(s.id)))});function N(a){return(a||"").toString().toLowerCase()}function c(a){var x;const s=N(d.value);return s?[`${a.person.firstName} ${a.person.lastName}`,a.studentNumber,(x=a.enrollmentStatus)==null?void 0:x.name].some(u=>N(u).includes(s)):!0}function o(a){return n.value==="all"?!0:String(a.enrollmentStatusId??"")===n.value}function L(a){return y.value==="all"?!0:String(a.gradeLevelId??"")===y.value}function v(a){if(!$.value)return!0;const s=String(a.enrollmentStatusId??"");return w.value.has(s)}const t=I(()=>i.students.filter(a=>c(a)&&o(a)&&L(a)&&v(a))),l=I(()=>t.value.length>0);function V(){d.value="",n.value="all",y.value="all",$.value=!1}function U(a){b.value=T(a)}function j(){b.value=null}function Q(a){if(!a)return"—";const s=new Date(a);return Number.isNaN(s.getTime())?"—":s.toLocaleDateString()}function X(a){window.confirm("Delete this student?")&&a.target.submit()}return(a,s)=>{var q,x;return f(),m(h,null,[e("section",ee,[e("header",te,[e("div",null,[s[5]||(s[5]=e("h1",{class:"card__title"},"Students",-1)),e("p",le,[e("strong",null,r(t.value.length),1),Y(" "+r(t.value.length===1?"record":"records")+" match your filters ",1)])]),s[6]||(s[6]=e("div",{class:"card__actions"},[e("a",{class:"btn",href:"/students/create"},"Add student"),e("a",{class:"btn btn--ghost",href:"/students"},"Clear search")],-1))]),e("form",se,[e("label",ne,[s[7]||(s[7]=e("span",null,"Search",-1)),g(e("input",{"onUpdate:modelValue":s[0]||(s[0]=u=>d.value=u),type:"search",name:"search",placeholder:"Name or student number"},null,512),[[D,d.value]])]),e("label",oe,[s[9]||(s[9]=e("span",null,"Status",-1)),g(e("select",{"onUpdate:modelValue":s[1]||(s[1]=u=>n.value=u)},[s[8]||(s[8]=e("option",{value:"all"},"All statuses",-1)),(f(!0),m(h,null,A(k.value,u=>(f(),m("option",{key:u.id,value:String(u.id)},r(u.name),9,ae))),128))],512),[[O,n.value]])]),e("label",re,[s[11]||(s[11]=e("span",null,"Grade",-1)),g(e("select",{"onUpdate:modelValue":s[2]||(s[2]=u=>y.value=u)},[s[10]||(s[10]=e("option",{value:"all"},"All grades",-1)),(f(!0),m(h,null,A(_.value,u=>(f(),m("option",{key:u.id,value:String(u.id)},r(u.name),9,ie))),128))],512),[[O,y.value]])]),e("label",de,[g(e("input",{type:"checkbox","onUpdate:modelValue":s[3]||(s[3]=u=>$.value=u)},null,512),[[M,$.value]]),s[12]||(s[12]=e("span",null,"Show active enrollment only",-1))]),s[13]||(s[13]=e("button",{type:"submit",class:"btn btn--ghost filters__submit"}," Apply on server ",-1)),e("button",{type:"button",class:"btn btn--link filters__submit",onClick:V}," Reset filters ")]),l.value?(f(),m("div",ue,[e("table",me,[s[15]||(s[15]=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Name"),e("th",{scope:"col"},"Status"),e("th",{scope:"col"},"Grade"),e("th",{scope:"col"},"Student #"),e("th",{scope:"col"},"Actions")])],-1)),e("tbody",null,[(f(!0),m(h,null,A(t.value,u=>{var R,z;return f(),m("tr",{key:u.id},[e("td",fe,[e("button",{type:"button",class:"table__link",onClick:J=>U(u)},r(u.person.firstName)+" "+r(u.person.lastName),9,pe)]),e("td",ve,r(((R=u.enrollmentStatus)==null?void 0:R.name)??"—"),1),e("td",be,r(((z=u.gradeLevel)==null?void 0:z.name)??"—"),1),e("td",_e,r(u.studentNumber||"—"),1),e("td",ce,[e("a",{href:`/students/${u.id}`,class:"btn btn--small btn--ghost"},"View",8,ge),e("a",{href:`/students/${u.id}/edit`,class:"btn btn--small"},"Edit",8,ye),e("form",{class:"form form--inline",action:`/students/${u.id}/delete`,method:"post",onSubmit:s[4]||(s[4]=G(J=>X(J),["prevent"]))},[e("input",{type:"hidden",name:"_csrf",value:p.csrfToken},null,8,Ne),s[14]||(s[14]=e("button",{type:"submit",class:"btn btn--small btn--danger"},"Delete",-1))],40,Se)])])}),128))])])])):(f(),m("p",$e," No students match your filters. Try adjusting them above. "))]),e("sq-modal",{open:!!b.value,heading:"Student summary",onClose:j},[b.value?(f(),m(h,{key:0},[e("sq-avatar-badge",{name:`${b.value.person.firstName} ${b.value.person.lastName}`,subtitle:((q=b.value.enrollmentStatus)==null?void 0:q.name)||"Student"},null,8,Ie),e("dl",he,[e("div",null,[s[16]||(s[16]=e("dt",null,"Grade",-1)),e("dd",null,r(((x=b.value.gradeLevel)==null?void 0:x.name)??"—"),1)]),e("div",null,[s[17]||(s[17]=e("dt",null,"Student number",-1)),e("dd",null,r(b.value.studentNumber||"—"),1)]),e("div",null,[s[18]||(s[18]=e("dt",null,"Admission date",-1)),e("dd",null,r(Q(b.value.admissionDate)),1)]),e("div",null,[s[19]||(s[19]=e("dt",null,"Primary email",-1)),e("dd",null,r(b.value.person.primaryEmail||"—"),1)]),e("div",null,[s[20]||(s[20]=e("dt",null,"Mobile phone",-1)),e("dd",null,r(b.value.person.mobilePhone||"—"),1)])]),e("div",De,[e("a",{href:`/students/${b.value.id}`,class:"btn btn--primary"},"Open profile",8,Ce),e("button",{type:"button",class:"btn",onClick:j},"Close")])],64)):E("",!0)],40,ke)],64)}}},Ee=F(Ve,[["__scopeId","data-v-207dbf99"]]),Ae={class:"card card--form"},we={class:"card__header"},Le={class:"card__title"},xe={key:0,class:"alert alert--danger",role:"alert"},Be=["action"],Oe=["value"],Te={class:"form__fieldset"},Ue={class:"form__grid"},qe={key:0,class:"form__hint"},Pe={class:"form__field"},Me={key:0,class:"form__hint"},Ge={class:"form__field"},Fe={class:"form__field"},je=["value"],Re={class:"form__field"},ze=["value"],Je={class:"toggle"},We={key:0,class:"form__grid form__grid--secondary"},He={class:"form__field"},Ke={class:"form__field"},Qe={class:"form__fieldset"},Xe={class:"form__grid"},Ye=["value"],Ze={key:0,class:"form__hint"},et={class:"form__field"},tt=["value"],lt={class:"form__field"},st={class:"form__field"},nt=["value"],ot={class:"toggle"},at={key:0,class:"form__grid form__grid--secondary"},rt={class:"form__field"},it=["value"],dt={class:"form__field form__field--full"},ut={class:"form__actions"},mt={type:"submit",class:"btn btn--primary"},ft={__name:"StudentFormApp",props:{lookups:{type:Object,default:()=>({genders:[],statuses:[],gradeLevels:[]})},values:{type:Object,default:()=>({})},errors:{type:Array,default:()=>[]},isEditMode:{type:Boolean,default:!1},studentId:{type:Number,default:null},csrfToken:{type:String,default:""},formAction:{type:String,default:"/students/create"}},setup(p){const i=p,d=C(null),n=T({firstName:i.values.firstName||"",middleName:i.values.middleName||"",lastName:i.values.lastName||"",preferredName:i.values.preferredName||"",dateOfBirth:i.values.dateOfBirth||"",genderId:i.values.genderId?String(i.values.genderId):"",primaryEmail:i.values.primaryEmail||"",mobilePhone:i.values.mobilePhone||"",enrollmentStatusId:i.values.enrollmentStatusId?String(i.values.enrollmentStatusId):"",gradeLevelId:i.values.gradeLevelId?String(i.values.gradeLevelId):"",studentNumber:i.values.studentNumber||"",admissionDate:i.values.admissionDate||"",graduationDate:i.values.graduationDate||"",notes:i.values.notes||""}),y=C(!!(n.primaryEmail||n.mobilePhone)),$=C(!!(n.graduationDate||n.notes)),b=I(()=>i.errors||[]),k=T({firstName:!1,lastName:!1,enrollmentStatusId:!1}),_=T({firstName:"",lastName:"",enrollmentStatusId:""}),w=I(()=>i.isEditMode?"Save changes":"Create student");function N(v){let t="";return v==="firstName"&&!n.firstName.trim()&&(t="First name is required."),v==="lastName"&&!n.lastName.trim()&&(t="Last name is required."),v==="enrollmentStatusId"&&!n.enrollmentStatusId&&(t="Enrollment status is required."),_[v]=t,!t}function c(v){k[v]=!0,N(v)}B(()=>n.firstName,()=>{k.firstName&&N("firstName")}),B(()=>n.lastName,()=>{k.lastName&&N("lastName")}),B(()=>n.enrollmentStatusId,()=>{k.enrollmentStatusId&&N("enrollmentStatusId")}),B(y,v=>{v||(n.primaryEmail="",n.mobilePhone="")}),B($,v=>{v||(n.graduationDate="",n.notes="")});function o(){var l,V;const v=Object.keys(_).find(U=>_[U]);if(!v)return;const t=(V=(l=d.value)==null?void 0:l.querySelector)==null?void 0:V.call(l,`[name="${v}"]`);t&&t.focus()}function L(){var V;k.firstName=!0,k.lastName=!0,k.enrollmentStatusId=!0;const v=N("firstName"),t=N("lastName"),l=N("enrollmentStatusId");if(!v||!t||!l){o();return}(V=d.value)==null||V.submit()}return(v,t)=>(f(),m("section",Ae,[e("header",we,[e("div",null,[e("h1",Le,r(p.isEditMode?"Edit student":"Add student"),1),t[19]||(t[19]=e("p",{class:"card__subtitle"}," Complete the required personal and enrollment information. ",-1))]),t[20]||(t[20]=e("a",{class:"btn btn--ghost",href:"/students"},"Back to list",-1))]),b.value.length?(f(),m("div",xe,[t[21]||(t[21]=e("p",null,[e("strong",null,"We ran into a few issues:")],-1)),e("ul",null,[(f(!0),m(h,null,A(b.value,l=>(f(),m("li",{key:l},r(l),1))),128))])])):E("",!0),e("form",{ref_key:"formRef",ref:d,method:"post",action:p.formAction,class:"form",onSubmit:G(L,["prevent"])},[e("input",{type:"hidden",name:"_csrf",value:p.csrfToken},null,8,Oe),e("fieldset",Te,[t[32]||(t[32]=e("legend",{class:"form__legend"},"Personal information",-1)),e("div",Ue,[e("label",{class:P(["form__field",{"form__field--error":_.firstName}])},[t[22]||(t[22]=e("span",{class:"form__label"},"First name *",-1)),g(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>n.firstName=l),name:"firstName",type:"text",autocomplete:"given-name",onBlur:t[1]||(t[1]=l=>c("firstName")),required:""},null,544),[[D,n.firstName,void 0,{trim:!0}]]),_.firstName?(f(),m("span",qe,r(_.firstName),1)):E("",!0)],2),e("label",Pe,[t[23]||(t[23]=e("span",{class:"form__label"},"Middle name",-1)),g(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>n.middleName=l),name:"middleName",type:"text",autocomplete:"additional-name"},null,512),[[D,n.middleName,void 0,{trim:!0}]])]),e("label",{class:P(["form__field",{"form__field--error":_.lastName}])},[t[24]||(t[24]=e("span",{class:"form__label"},"Last name *",-1)),g(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>n.lastName=l),name:"lastName",type:"text",autocomplete:"family-name",onBlur:t[4]||(t[4]=l=>c("lastName")),required:""},null,544),[[D,n.lastName,void 0,{trim:!0}]]),_.lastName?(f(),m("span",Me,r(_.lastName),1)):E("",!0)],2),e("label",Ge,[t[25]||(t[25]=e("span",{class:"form__label"},"Preferred name",-1)),g(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>n.preferredName=l),name:"preferredName",type:"text",autocomplete:"nickname"},null,512),[[D,n.preferredName,void 0,{trim:!0}]])]),e("label",Fe,[t[26]||(t[26]=e("span",{class:"form__label"},"Date of birth",-1)),e("sq-date-picker",{name:"dateOfBirth",value:n.dateOfBirth,label:"",onValueChange:t[6]||(t[6]=l=>n.dateOfBirth=l)},null,40,je)]),e("label",Re,[t[28]||(t[28]=e("span",{class:"form__label"},"Gender",-1)),g(e("select",{"onUpdate:modelValue":t[7]||(t[7]=l=>n.genderId=l),name:"genderId"},[t[27]||(t[27]=e("option",{value:""},"Select gender",-1)),(f(!0),m(h,null,A(p.lookups.genders,l=>(f(),m("option",{key:l.id,value:String(l.id)},r(l.name),9,ze))),128))],512),[[O,n.genderId]])])]),e("div",Je,[e("label",null,[g(e("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=l=>y.value=l)},null,512),[[M,y.value]]),t[29]||(t[29]=e("span",null,"Collect contact details",-1))])]),W(K,{name:"slide"},{default:H(()=>[y.value?(f(),m("div",We,[e("label",He,[t[30]||(t[30]=e("span",{class:"form__label"},"Primary email",-1)),g(e("input",{"onUpdate:modelValue":t[9]||(t[9]=l=>n.primaryEmail=l),name:"primaryEmail",type:"email",autocomplete:"email"},null,512),[[D,n.primaryEmail,void 0,{trim:!0}]])]),e("label",Ke,[t[31]||(t[31]=e("span",{class:"form__label"},"Mobile phone",-1)),g(e("input",{"onUpdate:modelValue":t[10]||(t[10]=l=>n.mobilePhone=l),name:"mobilePhone",type:"tel",autocomplete:"tel"},null,512),[[D,n.mobilePhone,void 0,{trim:!0}]])])])):E("",!0)]),_:1})]),e("fieldset",Qe,[t[42]||(t[42]=e("legend",{class:"form__legend"},"Enrollment details",-1)),e("div",Xe,[e("label",{class:P(["form__field",{"form__field--error":_.enrollmentStatusId}])},[t[34]||(t[34]=e("span",{class:"form__label"},"Enrollment status *",-1)),g(e("select",{"onUpdate:modelValue":t[11]||(t[11]=l=>n.enrollmentStatusId=l),name:"enrollmentStatusId",onBlur:t[12]||(t[12]=l=>c("enrollmentStatusId")),required:""},[t[33]||(t[33]=e("option",{value:""},"Select status",-1)),(f(!0),m(h,null,A(p.lookups.statuses,l=>(f(),m("option",{key:l.id,value:String(l.id)},r(l.name),9,Ye))),128))],544),[[O,n.enrollmentStatusId]]),_.enrollmentStatusId?(f(),m("span",Ze,r(_.enrollmentStatusId),1)):E("",!0)],2),e("label",et,[t[36]||(t[36]=e("span",{class:"form__label"},"Grade level",-1)),g(e("select",{"onUpdate:modelValue":t[13]||(t[13]=l=>n.gradeLevelId=l),name:"gradeLevelId"},[t[35]||(t[35]=e("option",{value:""},"Select grade",-1)),(f(!0),m(h,null,A(p.lookups.gradeLevels,l=>(f(),m("option",{key:l.id,value:String(l.id)},r(l.name),9,tt))),128))],512),[[O,n.gradeLevelId]])]),e("label",lt,[t[37]||(t[37]=e("span",{class:"form__label"},"Student number",-1)),g(e("input",{"onUpdate:modelValue":t[14]||(t[14]=l=>n.studentNumber=l),name:"studentNumber",type:"text",autocomplete:"off"},null,512),[[D,n.studentNumber,void 0,{trim:!0}]])]),e("label",st,[t[38]||(t[38]=e("span",{class:"form__label"},"Admission date",-1)),e("sq-date-picker",{name:"admissionDate",value:n.admissionDate,label:"",onValueChange:t[15]||(t[15]=l=>n.admissionDate=l)},null,40,nt)])]),e("div",ot,[e("label",null,[g(e("input",{type:"checkbox","onUpdate:modelValue":t[16]||(t[16]=l=>$.value=l)},null,512),[[M,$.value]]),t[39]||(t[39]=e("span",null,"Track graduation planning",-1))])]),W(K,{name:"slide"},{default:H(()=>[$.value?(f(),m("div",at,[e("label",rt,[t[40]||(t[40]=e("span",{class:"form__label"},"Graduation date",-1)),e("sq-date-picker",{name:"graduationDate",value:n.graduationDate,label:"",onValueChange:t[17]||(t[17]=l=>n.graduationDate=l)},null,40,it)]),e("label",dt,[t[41]||(t[41]=e("span",{class:"form__label"},"Notes",-1)),g(e("textarea",{"onUpdate:modelValue":t[18]||(t[18]=l=>n.notes=l),name:"notes",rows:"4"},null,512),[[D,n.notes,void 0,{trim:!0}]])])])):E("",!0)]),_:1})]),e("div",ut,[e("button",mt,r(w.value),1),t[43]||(t[43]=e("a",{class:"btn btn--link",href:"/students"},"Cancel",-1))])],40,Be)]))}},pt=F(ft,[["__scopeId","data-v-8a8c9139"]]),vt={class:"card card--detail"},bt={class:"card__header"},_t=["name","subtitle"],ct={class:"card__actions"},gt=["href"],yt=["action"],St=["value"],Nt={class:"detail-grid"},$t={class:"detail-card"},kt={class:"detail-card"},It={key:0,class:"detail-notes"},ht={key:1,class:"detail-empty"},Dt={class:"detail-meta"},Ct=["open"],Vt={class:"contact-list"},Et={__name:"StudentDetailApp",props:{student:{type:Object,required:!0},csrfToken:{type:String,default:""}},setup(p){const i=p,d=i.student,n=i.csrfToken,y=C(!1),$=I(()=>`${d.person.firstName} ${d.person.lastName}`.trim()),b=I(()=>{var c;return((c=d.enrollmentStatus)==null?void 0:c.name)||"—"}),k=I(()=>{var c;return((c=d.gradeLevel)==null?void 0:c.name)||"—"});function _(c){if(!c)return"—";const o=new Date(c);return Number.isNaN(o.getTime())?"—":o.toLocaleDateString()}function w(){y.value=!1}function N(c){window.confirm("Delete this student?")&&c.target.submit()}return(c,o)=>{var L;return f(),m(h,null,[e("section",vt,[e("header",bt,[e("sq-avatar-badge",{name:$.value,subtitle:b.value},null,8,_t),e("div",ct,[e("a",{href:`/students/${S(d).id}/edit`,class:"btn"},"Edit",8,gt),e("form",{class:"form form--inline",action:`/students/${S(d).id}/delete`,method:"post",onSubmit:o[0]||(o[0]=G(v=>N(v),["prevent"]))},[e("input",{type:"hidden",name:"_csrf",value:S(n)},null,8,St),o[2]||(o[2]=e("button",{type:"submit",class:"btn btn--danger"},"Delete",-1))],40,yt),o[3]||(o[3]=e("a",{href:"/students",class:"btn btn--link"},"Back to list",-1))])]),e("section",Nt,[e("article",$t,[o[9]||(o[9]=e("h2",null,"Enrollment overview",-1)),e("dl",null,[e("div",null,[o[4]||(o[4]=e("dt",null,"Status",-1)),e("dd",null,r(b.value),1)]),e("div",null,[o[5]||(o[5]=e("dt",null,"Grade level",-1)),e("dd",null,r(k.value),1)]),e("div",null,[o[6]||(o[6]=e("dt",null,"Student number",-1)),e("dd",null,r(S(d).studentNumber||"—"),1)]),e("div",null,[o[7]||(o[7]=e("dt",null,"Admission date",-1)),e("dd",null,r(_(S(d).admissionDate)),1)]),e("div",null,[o[8]||(o[8]=e("dt",null,"Graduation date",-1)),e("dd",null,r(_(S(d).graduationDate)),1)])]),e("button",{type:"button",class:"btn btn--ghost",onClick:o[1]||(o[1]=v=>y.value=!0)}," View contact details ")]),e("article",kt,[o[13]||(o[13]=e("h2",null,"Personal notes",-1)),S(d).notes?(f(),m("p",It,r(S(d).notes),1)):(f(),m("p",ht,"No additional notes available.")),e("ul",Dt,[e("li",null,[o[10]||(o[10]=e("strong",null,"Preferred name",-1)),e("span",null,r(S(d).person.preferredName||"—"),1)]),e("li",null,[o[11]||(o[11]=e("strong",null,"Date of birth",-1)),e("span",null,r(_(S(d).person.dateOfBirth)),1)]),e("li",null,[o[12]||(o[12]=e("strong",null,"Gender",-1)),e("span",null,r(((L=S(d).person.gender)==null?void 0:L.name)||"—"),1)])])])])]),e("sq-modal",{open:y.value,heading:"Contact details",onClose:w},[e("dl",Vt,[e("div",null,[o[14]||(o[14]=e("dt",null,"Primary email",-1)),e("dd",null,r(S(d).person.primaryEmail||"—"),1)]),e("div",null,[o[15]||(o[15]=e("dt",null,"Mobile phone",-1)),e("dd",null,r(S(d).person.mobilePhone||"—"),1)])]),e("div",{slot:"footer"},[e("button",{type:"button",class:"btn",onClick:w},"Close")])],40,Ct)],64)}}},At=F(Et,[["__scopeId","data-v-82154b06"]]),wt={StudentListApp:Ee,StudentFormApp:pt,StudentDetailApp:At};function Lt(p){if(!p)return{};const i=document.getElementById(p);if(!i)return{};try{return JSON.parse(i.textContent||"{}")}catch(d){return console.warn(`Unable to parse state for ${p}`,d),{}}}function xt(p){const i=p.dataset.vueApp,d=wt[i];if(!d)return;const n=Lt(p.dataset.stateId);Z(d,n).mount(p)}document.querySelectorAll('[data-vue-app^="Student"]').forEach(p=>xt(p));
//# sourceMappingURL=students.js.map
